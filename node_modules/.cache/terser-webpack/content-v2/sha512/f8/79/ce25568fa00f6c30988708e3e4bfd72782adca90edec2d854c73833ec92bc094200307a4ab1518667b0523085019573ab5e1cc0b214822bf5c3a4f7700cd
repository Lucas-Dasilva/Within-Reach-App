{"code":"(window.webpackJsonp=window.webpackJsonp||[]).push([[14],{\"99Un\":function(module,__webpack_exports__,__webpack_require__){\"use strict\";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,\"HomePageModule\",(function(){return home_module_HomePageModule}));var common=__webpack_require__(\"ofXK\"),fesm2015_forms=__webpack_require__(\"3Pt+\"),ionic_angular=__webpack_require__(\"TEn/\"),fesm2015_router=__webpack_require__(\"tyNb\"),tslib_es6=__webpack_require__(\"mrSG\"),create_post_page=__webpack_require__(\"4WUr\"),BehaviorSubject=__webpack_require__(\"2Vo4\"),switchMap=__webpack_require__(\"eIep\"),Subject=__webpack_require__(\"XNiG\"),core=__webpack_require__(\"fXoL\"),location_service=__webpack_require__(\"yHma\"),get_data_service=__webpack_require__(\"EQNs\"),post_data_service=__webpack_require__(\"2ZZ0\"),user_service=__webpack_require__(\"qfBg\"),vote_button_component=__webpack_require__(\"/Hhz\"),humanize_pipe=__webpack_require__(\"Wu1i\");function HomePage_ion_chip_2_Template(rf,ctx){if(1&rf&&(core.Kb(0,\"ion-chip\",12),core.Kb(1,\"ion-label\"),core.jc(2),core.Jb(),core.Jb()),2&rf){const user_r2=ctx.ngIf;core.xb(2),core.kc(user_r2.karma)}}function HomePage_ion_list_17_ion_card_1_ion_col_13_Template(rf,ctx){if(1&rf){const _r11=core.Lb();core.Kb(0,\"ion-col\",22),core.Sb(\"click\",(function(){core.dc(_r11);const post_r5=core.Ub().$implicit;return core.Ub(2).gotToComments(post_r5.id)})),core.Ib(1,\"ion-icon\",23),core.Kb(2,\"div\",21),core.jc(3,\"none\"),core.Jb(),core.Jb()}}function HomePage_ion_list_17_ion_card_1_ion_col_14_Template(rf,ctx){if(1&rf){const _r14=core.Lb();core.Kb(0,\"ion-col\",22),core.Sb(\"click\",(function(){core.dc(_r14);const post_r5=core.Ub().$implicit;return core.Ub(2).gotToComments(post_r5.id)})),core.Ib(1,\"ion-icon\",23),core.Kb(2,\"div\",21),core.jc(3,\"1 reply\"),core.Jb(),core.Jb()}}function HomePage_ion_list_17_ion_card_1_ion_col_15_Template(rf,ctx){if(1&rf){const _r17=core.Lb();core.Kb(0,\"ion-col\",22),core.Sb(\"click\",(function(){core.dc(_r17);const post_r5=core.Ub().$implicit;return core.Ub(2).gotToComments(post_r5.id)})),core.Ib(1,\"ion-icon\",24),core.Kb(2,\"div\",21),core.jc(3),core.Jb(),core.Jb()}if(2&rf){const post_r5=core.Ub().$implicit;core.xb(3),core.lc(\"\",post_r5.reply_count,\" replies\")}}function HomePage_ion_list_17_ion_card_1_Template(rf,ctx){if(1&rf){const _r20=core.Lb();core.Kb(0,\"ion-card\"),core.Kb(1,\"ion-row\"),core.Kb(2,\"ion-col\",14),core.Sb(\"click\",(function(){core.dc(_r20);const post_r5=ctx.$implicit;return core.Ub(2).gotToComments(post_r5.id)})),core.jc(3),core.Jb(),core.Kb(4,\"ion-col\",15),core.Ib(5,\"app-vote-button\",16),core.Jb(),core.Jb(),core.Kb(6,\"ion-footer\",1),core.Kb(7,\"ion-grid\"),core.Kb(8,\"ion-row\"),core.Kb(9,\"ion-col\",17),core.Ib(10,\"ion-icon\",18),core.jc(11),core.Vb(12,\"datepipe\"),core.Jb(),core.hc(13,HomePage_ion_list_17_ion_card_1_ion_col_13_Template,4,0,\"ion-col\",19),core.hc(14,HomePage_ion_list_17_ion_card_1_ion_col_14_Template,4,0,\"ion-col\",19),core.hc(15,HomePage_ion_list_17_ion_card_1_ion_col_15_Template,4,1,\"ion-col\",19),core.Kb(16,\"ion-col\",20),core.Kb(17,\"div\",21),core.jc(18),core.Jb(),core.Jb(),core.Jb(),core.Jb(),core.Jb(),core.Jb()}if(2&rf){const post_r5=ctx.$implicit,posts_r3=core.Ub().ngIf;core.xb(3),core.lc(\" \",post_r5.body,\" \"),core.xb(2),core.Zb(\"reactions\",posts_r3.react_list)(\"post_id\",post_r5.id)(\"post_user\",post_r5.user_id)(\"likes\",post_r5.likes),core.xb(6),core.lc(\" \",core.Wb(12,10,post_r5.timestamp),\" \"),core.xb(2),core.Zb(\"ngIf\",0==post_r5.reply_count),core.xb(1),core.Zb(\"ngIf\",1==post_r5.reply_count),core.xb(1),core.Zb(\"ngIf\",post_r5.reply_count>1),core.xb(3),core.lc(\" \",post_r5.distance,\" miles\")}}function HomePage_ion_list_17_Template(rf,ctx){if(1&rf&&(core.Kb(0,\"ion-list\",1),core.hc(1,HomePage_ion_list_17_ion_card_1_Template,19,12,\"ion-card\",13),core.Jb()),2&rf){const posts_r3=ctx.ngIf;core.xb(1),core.Zb(\"ngForOf\",posts_r3.post_list)}}const routes=[{path:\"\",component:(()=>{class HomePage{constructor(location,getData,modalCtrl,postData,nav,router,user){this.location=location,this.getData=getData,this.modalCtrl=modalCtrl,this.postData=postData,this.nav=nav,this.router=router,this.user=user,this.stopPolling=new Subject.a,this.refresh$=new BehaviorSubject.a(!0)}ngOnInit(){return Object(tslib_es6.a)(this,void 0,void 0,(function*(){try{yield this.user.userInfo(),yield this.location.getCoords(),this.user_id=this.user.uuid,this.userLat=this.location.currentLocation.latitude,this.userLon=this.location.currentLocation.longitude,this.user$=this.refresh$.pipe(Object(switchMap.a)(_=>this.getData.getUser(this.user.uuid))),this.posts$=this.refresh$.pipe(Object(switchMap.a)(_=>this.getData.getPosts(this.userLat,this.userLon,this.user.uuid)))}catch(_a){this.nav.navigateRoot(\"error\")}}))}ionViewWillEnter(){this.refresh$.next(!0)}doRefresh($event){return Object(tslib_es6.a)(this,void 0,void 0,(function*(){setTimeout(()=>{this.refresh$.next(!0),$event.target.complete()},1e3)}))}sortPosts(event){\"hot\"==event.target.value?this.posts$=this.refresh$.pipe(Object(switchMap.a)(_=>this.getData.getPostsSorted(this.userLat,this.userLon,this.user_id))):\"new\"==event.target.value&&(this.posts$=this.refresh$.pipe(Object(switchMap.a)(_=>this.getData.getPosts(this.userLat,this.userLon,this.user_id))))}createPost(){return Object(tslib_es6.a)(this,void 0,void 0,(function*(){let postModal=yield this.modalCtrl.create({component:create_post_page.a});yield postModal.present(),postModal.onDidDismiss().then(data=>{null!=data.data&&(this.userLat=this.location.currentLocation.latitude,this.userLon=this.location.currentLocation.longitude,this.postData.createPostRequest(this.userLat,this.userLon,this.user_id,data.data.postBod).then(()=>{this.refresh$.next(!0)}))})}))}gotToComments(post_id){let navigationExtras={queryParams:{post_id:JSON.stringify(post_id)}};this.router.navigate([\"comments\"],navigationExtras)}ngOnDestroy(){this.stopPolling.next()}}return HomePage.ɵfac=function(t){return new(t||HomePage)(core.Hb(location_service.a),core.Hb(get_data_service.a),core.Hb(ionic_angular.E),core.Hb(post_data_service.a),core.Hb(ionic_angular.F),core.Hb(fesm2015_router.g),core.Hb(user_service.a))},HomePage.ɵcmp=core.Bb({type:HomePage,selectors:[[\"app-home\"]],decls:19,vars:7,consts:[[3,\"translucent\"],[\"mode\",\"ios\"],[\"lines\",\"none\",\"slot\",\"start\",4,\"ngIf\"],[\"mode\",\"ios\",\"value\",\"new\",3,\"ionChange\"],[\"value\",\"new\"],[\"value\",\"hot\"],[\"slot\",\"end\"],[3,\"click\"],[\"name\",\"create-outline\"],[\"slot\",\"fixed\",3,\"ionRefresh\"],[\"pullingIcon\",\"circular\"],[\"mode\",\"ios\",4,\"ngIf\"],[\"lines\",\"none\",\"slot\",\"start\"],[4,\"ngFor\",\"ngForOf\"],[1,\"body\",3,\"click\"],[\"size\",\"2\",1,\"vote\"],[3,\"reactions\",\"post_id\",\"post_user\",\"likes\"],[\"size\",\"4\",1,\"time\"],[\"name\",\"time-outline\"],[\"size\",\"4\",\"class\",\"reply\",3,\"click\",4,\"ngIf\"],[\"size\",\"4\",1,\"distance\"],[1,\"text\"],[\"size\",\"4\",1,\"reply\",3,\"click\"],[\"name\",\"chatbubble-outline\"],[\"name\",\"chatbubbles-outline\"]],template:function(rf,ctx){1&rf&&(core.Kb(0,\"ion-header\",0),core.Kb(1,\"ion-toolbar\",1),core.hc(2,HomePage_ion_chip_2_Template,3,1,\"ion-chip\",2),core.Vb(3,\"async\"),core.Kb(4,\"ion-segment\",3),core.Sb(\"ionChange\",(function($event){return ctx.sortPosts($event)})),core.Kb(5,\"ion-segment-button\",4),core.Kb(6,\"ion-label\"),core.jc(7,\"New\"),core.Jb(),core.Jb(),core.Kb(8,\"ion-segment-button\",5),core.Kb(9,\"ion-label\"),core.jc(10,\"Hot\"),core.Jb(),core.Jb(),core.Jb(),core.Kb(11,\"ion-buttons\",6),core.Kb(12,\"ion-button\",7),core.Sb(\"click\",(function(){return ctx.createPost()})),core.Ib(13,\"ion-icon\",8),core.Jb(),core.Jb(),core.Jb(),core.Jb(),core.Kb(14,\"ion-content\"),core.Kb(15,\"ion-refresher\",9),core.Sb(\"ionRefresh\",(function($event){return ctx.doRefresh($event)})),core.Ib(16,\"ion-refresher-content\",10),core.Jb(),core.hc(17,HomePage_ion_list_17_Template,2,1,\"ion-list\",11),core.Vb(18,\"async\"),core.Jb()),2&rf&&(core.Zb(\"translucent\",!0),core.xb(2),core.Zb(\"ngIf\",core.Wb(3,3,ctx.user$)),core.xb(15),core.Zb(\"ngIf\",core.Wb(18,5,ctx.posts$)))},directives:[ionic_angular.m,ionic_angular.A,common.k,ionic_angular.w,ionic_angular.H,ionic_angular.x,ionic_angular.q,ionic_angular.f,ionic_angular.e,ionic_angular.n,ionic_angular.j,ionic_angular.s,ionic_angular.t,ionic_angular.h,ionic_angular.r,common.j,ionic_angular.g,ionic_angular.v,ionic_angular.i,vote_button_component.a,ionic_angular.k,ionic_angular.l],pipes:[common.b,humanize_pipe.a],styles:[\"ion-footer[_ngcontent-%COMP%]{display:inline;margin:auto}ion-chip[_ngcontent-%COMP%], ion-refresher[_ngcontent-%COMP%]{--color:#5600f7}ion-chip[_ngcontent-%COMP%]{--background:#fff}ion-label[_ngcontent-%COMP%]{font-weight:700}ion-button[_ngcontent-%COMP%]{--color:#5600f7}ion-icon[_ngcontent-%COMP%]{vertical-align:middle;padding-bottom:3.5px}.time[_ngcontent-%COMP%]{padding-left:4px}.distance[_ngcontent-%COMP%], .time[_ngcontent-%COMP%]{font-size:13px;padding-top:1em;color:#7972da}.distance[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;margin:auto;padding-right:4px}.vote[_ngcontent-%COMP%]{display:flex;padding-bottom:0;align-items:center}.reply[_ngcontent-%COMP%]{font-size:13px;justify-content:center;padding-top:1em;display:flex}.text[_ngcontent-%COMP%]{margin-left:.5em}.body[_ngcontent-%COMP%]{padding:1em}@media (prefers-color-scheme:light){ion-card[_ngcontent-%COMP%]{box-shadow:5px 5px 15px 5px hsla(0,0%,66.7%,.41);--color:#5f656d}}@media (prefers-color-scheme:dark){ion-card[_ngcontent-%COMP%]{box-shadow:2px 2px 17px 4px rgba(0,0,0,.41)}}\"]}),HomePage})()}];let home_routing_module_HomePageRoutingModule=(()=>{class HomePageRoutingModule{}return HomePageRoutingModule.ɵmod=core.Fb({type:HomePageRoutingModule}),HomePageRoutingModule.ɵinj=core.Eb({factory:function(t){return new(t||HomePageRoutingModule)},imports:[[fesm2015_router.i.forChild(routes)],fesm2015_router.i]}),HomePageRoutingModule})();var component_module=__webpack_require__(\"nETc\");let home_module_HomePageModule=(()=>{class HomePageModule{}return HomePageModule.ɵmod=core.Fb({type:HomePageModule}),HomePageModule.ɵinj=core.Eb({factory:function(t){return new(t||HomePageModule)},imports:[[common.c,fesm2015_forms.a,ionic_angular.B,home_routing_module_HomePageRoutingModule,component_module.a]]}),HomePageModule})()}}]);","extractedComments":[]}