{"code":"(window.webpackJsonp=window.webpackJsonp||[]).push([[11],{qhKe:function(module,__webpack_exports__,__webpack_require__){\"use strict\";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,\"CommentsPageModule\",(function(){return comments_module_CommentsPageModule}));var common=__webpack_require__(\"ofXK\"),fesm2015_forms=__webpack_require__(\"3Pt+\"),ionic_angular=__webpack_require__(\"TEn/\"),router=__webpack_require__(\"tyNb\"),tslib_es6=__webpack_require__(\"mrSG\"),BehaviorSubject=__webpack_require__(\"2Vo4\"),switchMap=__webpack_require__(\"eIep\"),Subject=__webpack_require__(\"XNiG\"),core=__webpack_require__(\"fXoL\"),get_data_service=__webpack_require__(\"EQNs\"),post_data_service=__webpack_require__(\"2ZZ0\"),user_service=__webpack_require__(\"qfBg\"),vote_button_component=__webpack_require__(\"/Hhz\"),http=__webpack_require__(\"tk/3\");function ReplyVoteButtonComponent_div_0_Template(rf,ctx){if(1&rf&&(core.Kb(0,\"div\",2),core.Ib(1,\"ion-icon\",3),core.Kb(2,\"div\",4),core.jc(3),core.Jb(),core.Ib(4,\"ion-icon\",5),core.Jb()),2&rf){const ctx_r0=core.Ub();core.xb(3),core.kc(ctx_r0.votecount)}}const _c0=function(a0){return{\"active up\":a0}},_c1=function(a0){return{\"active down\":a0}};function ReplyVoteButtonComponent_ng_template_1_Template(rf,ctx){if(1&rf){const _r4=core.Lb();core.Kb(0,\"div\",2),core.Kb(1,\"ion-icon\",6),core.Sb(\"click\",(function(){return core.dc(_r4),core.Ub().upVote()})),core.Jb(),core.Kb(2,\"div\",4),core.jc(3),core.Jb(),core.Kb(4,\"ion-icon\",7),core.Sb(\"click\",(function(){return core.dc(_r4),core.Ub().downVote()})),core.Jb(),core.Jb()}if(2&rf){const ctx_r2=core.Ub();core.xb(1),core.Zb(\"ngClass\",core.ac(3,_c0,ctx_r2.user_vote>0)),core.xb(2),core.kc(ctx_r2.votecount),core.xb(1),core.Zb(\"ngClass\",core.ac(5,_c1,ctx_r2.user_vote<0))}}let reply_vote_button_component_ReplyVoteButtonComponent=(()=>{class ReplyVoteButtonComponent{constructor(user,http){this.user=user,this.http=http,this.owner=!1,this.url=\"https://officialwithinreach.herokuapp.com/\"}ngOnInit(){return Object(tslib_es6.a)(this,void 0,void 0,(function*(){yield this.user.userInfo(),this.local_user=this.user.uuid;const reaction=this.reactions.find(reaction=>reaction.post==this.reply_id);null!=reaction&&(this.user_vote=reaction.status),this.votecount=this.likes,this.post_user==this.local_user&&(this.owner=!0)}))}upVote(){1==this.user_vote?(this.user_vote=0,this.votecount=this.votecount-1):-1==this.user_vote?(this.user_vote=1,this.votecount=this.votecount+2):(this.user_vote=1,this.votecount=this.votecount+1),this.http.post(this.url+\"upvotereplyHandler\",{user_id:this.local_user,reply_id:this.reply_id},{responseType:\"text\"}).toPromise().then(response=>{}).catch(console.log)}downVote(){-1==this.user_vote?(this.user_vote=0,this.votecount=this.votecount+1):1==this.user_vote?(this.user_vote=-1,this.votecount=this.votecount-2):(this.user_vote=-1,this.votecount=this.votecount-1),this.http.post(this.url+\"downvotereplyHandler\",{user_id:this.local_user,reply_id:this.reply_id},{responseType:\"text\"}).toPromise().then(response=>{}).catch(console.log)}}return ReplyVoteButtonComponent.ɵfac=function(t){return new(t||ReplyVoteButtonComponent)(core.Hb(user_service.a),core.Hb(http.b))},ReplyVoteButtonComponent.ɵcmp=core.Bb({type:ReplyVoteButtonComponent,selectors:[[\"app-reply-vote-button\"]],inputs:{post_user:\"post_user\",reply_id:\"reply_id\",likes:\"likes\",reactions:\"reactions\"},decls:3,vars:2,consts:[[\"class\",\"votebox\",4,\"ngIf\",\"ngIfElse\"],[\"react\",\"\"],[1,\"votebox\"],[\"name\",\"chevron-up\",1,\"active\",\"up\"],[1,\"likecount\"],[\"name\",\"chevron-down\",1,\"vote\"],[\"name\",\"chevron-up\",3,\"ngClass\",\"click\"],[\"name\",\"chevron-down\",3,\"ngClass\",\"click\"]],template:function(rf,ctx){if(1&rf&&(core.hc(0,ReplyVoteButtonComponent_div_0_Template,5,1,\"div\",0),core.hc(1,ReplyVoteButtonComponent_ng_template_1_Template,5,7,\"ng-template\",null,1,core.ic)),2&rf){const _r1=core.cc(2);core.Zb(\"ngIf\",1==ctx.owner)(\"ngIfElse\",_r1)}},directives:[common.k,ionic_angular.o,common.i],styles:[\"@media (prefers-color-scheme:light){.votebox[_ngcontent-%COMP%]{display:flex;flex-direction:column;font-size:2em;align-items:center;color:#dce1e5}.votebox[_ngcontent-%COMP%]   .active.down[_ngcontent-%COMP%], .votebox[_ngcontent-%COMP%]   .active.up[_ngcontent-%COMP%]{color:#5600f7}.likecount[_ngcontent-%COMP%]{font-size:.65em;color:#5f656d}}@media (prefers-color-scheme:dark){.votebox[_ngcontent-%COMP%]{display:flex;flex-direction:column;font-size:2em;align-items:center;color:#555b62}.votebox[_ngcontent-%COMP%]   .active.down[_ngcontent-%COMP%], .votebox[_ngcontent-%COMP%]   .active.up[_ngcontent-%COMP%]{color:#6161bd}.likecount[_ngcontent-%COMP%]{font-size:.6em;color:#bcbbbe}}\"]}),ReplyVoteButtonComponent})();var humanize_pipe=__webpack_require__(\"Wu1i\");const comments_page_c0=[\"content\"];function CommentsPage_div_11_ion_col_12_Template(rf,ctx){1&rf&&(core.Kb(0,\"ion-col\",23),core.Ib(1,\"ion-icon\",24),core.Kb(2,\"div\",25),core.jc(3,\"none\"),core.Jb(),core.Jb())}function CommentsPage_div_11_ion_col_13_Template(rf,ctx){1&rf&&(core.Kb(0,\"ion-col\",23),core.Ib(1,\"ion-icon\",24),core.Kb(2,\"div\",25),core.jc(3,\"1 reply\"),core.Jb(),core.Jb())}function CommentsPage_div_11_ion_col_14_Template(rf,ctx){if(1&rf&&(core.Kb(0,\"ion-col\",23),core.Ib(1,\"ion-icon\",26),core.Kb(2,\"div\",25),core.jc(3),core.Jb(),core.Jb()),2&rf){const replys_r2=core.Ub().ngIf;core.xb(3),core.lc(\"\",replys_r2.post.reply_count,\" replies\")}}function CommentsPage_div_11_Template(rf,ctx){if(1&rf&&(core.Kb(0,\"div\",12),core.Kb(1,\"ion-card\",13),core.Kb(2,\"ion-row\",14),core.Kb(3,\"ion-col\",15),core.jc(4),core.Jb(),core.Kb(5,\"ion-col\",16),core.Ib(6,\"app-vote-button\",17),core.Jb(),core.Jb(),core.Kb(7,\"ion-row\",18),core.Kb(8,\"ion-col\",19),core.Ib(9,\"ion-icon\",20),core.jc(10),core.Vb(11,\"datepipe\"),core.Jb(),core.hc(12,CommentsPage_div_11_ion_col_12_Template,4,0,\"ion-col\",21),core.hc(13,CommentsPage_div_11_ion_col_13_Template,4,0,\"ion-col\",21),core.hc(14,CommentsPage_div_11_ion_col_14_Template,4,1,\"ion-col\",21),core.Ib(15,\"ion-col\",22),core.Jb(),core.Jb(),core.Jb()),2&rf){const replys_r2=ctx.ngIf;core.xb(4),core.lc(\" \",replys_r2.post.body,\" \"),core.xb(2),core.Zb(\"reactions\",replys_r2.post_reactions)(\"post_id\",replys_r2.post.id)(\"post_user\",replys_r2.post.user_id)(\"likes\",replys_r2.post.likes),core.xb(4),core.lc(\" \",core.Wb(11,9,replys_r2.post.timestamp),\" \"),core.xb(2),core.Zb(\"ngIf\",0==replys_r2.post.reply_count),core.xb(1),core.Zb(\"ngIf\",1==replys_r2.post.reply_count),core.xb(1),core.Zb(\"ngIf\",replys_r2.post.reply_count>1)}}function CommentsPage_ion_content_13_ion_card_3_Template(rf,ctx){if(1&rf&&(core.Kb(0,\"ion-card\",30),core.Kb(1,\"ion-row\"),core.Kb(2,\"ion-col\",15),core.jc(3),core.Jb(),core.Kb(4,\"ion-col\",16),core.Ib(5,\"app-reply-vote-button\",31),core.Jb(),core.Jb(),core.Kb(6,\"ion-row\",18),core.Kb(7,\"ion-col\",19),core.jc(8),core.Vb(9,\"datepipe\"),core.Jb(),core.Ib(10,\"ion-col\",22),core.Ib(11,\"ion-col\",22),core.Jb(),core.Jb()),2&rf){const reply_r10=ctx.$implicit,replys_r7=core.Ub().ngIf;core.xb(3),core.lc(\" \",reply_r10.body,\" \"),core.xb(2),core.Zb(\"reactions\",replys_r7.react_list)(\"reply_id\",reply_r10.id)(\"post_user\",reply_r10.user_id)(\"likes\",reply_r10.likes),core.xb(3),core.lc(\" \",core.Wb(9,6,reply_r10.timestamp),\" \")}}function CommentsPage_ion_content_13_Template(rf,ctx){if(1&rf&&(core.Kb(0,\"ion-content\",27,28),core.Kb(2,\"ion-list\"),core.hc(3,CommentsPage_ion_content_13_ion_card_3_Template,12,8,\"ion-card\",29),core.Jb(),core.Jb()),2&rf){const replys_r7=ctx.ngIf;core.xb(3),core.Zb(\"ngForOf\",replys_r7.reply_list)}}const routes=[{path:\"\",component:(()=>{class CommentsPage{constructor(nav,route,getData,postData,user){this.nav=nav,this.route=route,this.getData=getData,this.postData=postData,this.user=user,this.stopPolling=new Subject.a,this.refresh$=new BehaviorSubject.a(!0),this.replyBody=\"\",this.route.queryParams.subscribe(params=>{params&&(this.post_id=JSON.parse(params.post_id))})}ngOnInit(){return Object(tslib_es6.a)(this,void 0,void 0,(function*(){yield this.user.userInfo(),this.replys$=this.refresh$.pipe(Object(switchMap.a)(_=>this.getData.getReplys(this.post_id,this.user.uuid)))}))}sendMessage(){return Object(tslib_es6.a)(this,void 0,void 0,(function*(){0!=this.replyBody.length&&(yield this.postData.createReplyRequest(this.user.uuid,this.post_id,this.replyBody).then(()=>{this.refresh$.next(!0)}),setTimeout(()=>this.content.scrollToBottom(300),250)),this.replyBody=\"\"}))}ionViewDidEnter(){this.content.scrollToBottom(300)}gotToHome(){this.nav.back()}ngOnDestroy(){this.stopPolling.next()}}return CommentsPage.ɵfac=function(t){return new(t||CommentsPage)(core.Hb(ionic_angular.G),core.Hb(router.a),core.Hb(get_data_service.a),core.Hb(post_data_service.a),core.Hb(user_service.a))},CommentsPage.ɵcmp=core.Bb({type:CommentsPage,selectors:[[\"app-comments\"]],viewQuery:function(rf,ctx){var _t;1&rf&&core.mc(comments_page_c0,!0),2&rf&&core.bc(_t=core.Tb())&&(ctx.content=_t.first)},decls:20,vars:8,consts:[[\"slot\",\"start\"],[\"defaultHref\",\"home\",\"text\",\"\",\"icon\",\"chevron-back\"],[1,\"centercontent\"],[\"color\",\"dark\",1,\"label\"],[\"slot\",\"end\"],[\"name\",\"flag-outline\",\"color\",\"danger\"],[\"class\",\"topContent\",4,\"ngIf\"],[\"class\",\"botContent\",4,\"ngIf\"],[\"lines\",\"full\",1,\"box\"],[\"enterkeyhint\",\"send\",\"minlength\",\"1\",\"clearInput\",\"true\",\"maxlength\",\"200\",\"autocorrect\",\"on\",\"autocomplete\",\"on\",\"inputmode\",\"text\",\"autofocus\",\"true\",\"placeholder\",\"Reply Back\",3,\"ngModel\",\"keyup.enter\",\"ngModelChange\"],[\"expland\",\"block\",\"fill\",\"clear\",1,\"send-btn\",3,\"disabled\",\"click\"],[\"name\",\"send-outline\",\"slot\",\"icon-only\"],[1,\"topContent\"],[1,\"mainCard\"],[1,\"mainRow\"],[\"size\",\"10\",1,\"body\"],[\"size\",\"2\",1,\"vote\"],[3,\"reactions\",\"post_id\",\"post_user\",\"likes\"],[\"size\",\"1\"],[\"size\",\"5\",1,\"time\"],[\"name\",\"time-outline\"],[\"size\",\"4\",\"class\",\"reply\",4,\"ngIf\"],[1,\"reply\"],[\"size\",\"4\",1,\"reply\"],[\"name\",\"chatbubble-outline\"],[1,\"text\"],[\"name\",\"chatbubbles-outline\"],[1,\"botContent\"],[\"content\",\"\"],[\"class\",\"replyCard\",4,\"ngFor\",\"ngForOf\"],[1,\"replyCard\"],[3,\"reactions\",\"reply_id\",\"post_user\",\"likes\"]],template:function(rf,ctx){1&rf&&(core.Kb(0,\"ion-header\"),core.Kb(1,\"ion-toolbar\"),core.Kb(2,\"ion-buttons\",0),core.Kb(3,\"ion-button\"),core.Ib(4,\"ion-back-button\",1),core.Jb(),core.Jb(),core.Kb(5,\"div\",2),core.Kb(6,\"ion-label\",3),core.jc(7,\"Details\"),core.Jb(),core.Jb(),core.Kb(8,\"ion-buttons\",4),core.Kb(9,\"ion-button\"),core.Ib(10,\"ion-icon\",5),core.Jb(),core.Jb(),core.Jb(),core.hc(11,CommentsPage_div_11_Template,16,11,\"div\",6),core.Vb(12,\"async\"),core.Jb(),core.hc(13,CommentsPage_ion_content_13_Template,4,1,\"ion-content\",7),core.Vb(14,\"async\"),core.Kb(15,\"ion-footer\"),core.Kb(16,\"ion-item\",8),core.Kb(17,\"ion-input\",9),core.Sb(\"keyup.enter\",(function(){return ctx.sendMessage()}))(\"ngModelChange\",(function($event){return ctx.replyBody=$event})),core.Jb(),core.Kb(18,\"ion-button\",10),core.Sb(\"click\",(function(){return ctx.sendMessage()})),core.Ib(19,\"ion-icon\",11),core.Jb(),core.Jb(),core.Jb()),2&rf&&(core.xb(11),core.Zb(\"ngIf\",core.Wb(12,4,ctx.replys$)),core.xb(2),core.Zb(\"ngIf\",core.Wb(14,6,ctx.replys$)),core.xb(4),core.Zb(\"ngModel\",ctx.replyBody),core.xb(1),core.Zb(\"disabled\",\"\"===ctx.replyBody))},directives:[ionic_angular.n,ionic_angular.B,ionic_angular.g,ionic_angular.f,ionic_angular.d,ionic_angular.e,ionic_angular.r,ionic_angular.o,common.k,ionic_angular.l,ionic_angular.q,ionic_angular.p,ionic_angular.J,fesm2015_forms.c,fesm2015_forms.b,fesm2015_forms.f,fesm2015_forms.g,ionic_angular.h,ionic_angular.w,ionic_angular.j,vote_button_component.a,ionic_angular.k,ionic_angular.s,common.j,reply_vote_button_component_ReplyVoteButtonComponent],pipes:[common.b,humanize_pipe.a],styles:[\"ion-back-button[_ngcontent-%COMP%]{--color:#5600f7}ion-icon[_ngcontent-%COMP%]{vertical-align:middle;padding-bottom:3px}.centercontent[_ngcontent-%COMP%]{text-align:center;font-weight:700;margin-right:2em}.topContent[_ngcontent-%COMP%]{border-bottom:2px solid #bcbbbe;background-image:url(/assets/img/mapblur.jpg);background-size:cover;background-repeat:no-repeat;vertical-align:middle;width:100%;padding-top:1em;padding-bottom:1em}.ionic-content[_ngcontent-%COMP%]{--offset-bottom:0!important}.scroll-content[_ngcontent-%COMP%]{padding-bottom:0!important}.mainRow[_ngcontent-%COMP%]{height:10em}.time[_ngcontent-%COMP%]{padding-top:0;padding-left:1em;color:#7972da}.vote[_ngcontent-%COMP%]{display:flex;padding-bottom:0;align-items:center}.reply[_ngcontent-%COMP%]{justify-content:left;padding-top:0;display:flex}.text[_ngcontent-%COMP%]{margin-left:.5em}.body[_ngcontent-%COMP%]{padding:1em}.cancel[_ngcontent-%COMP%]{color:#f04747}@media (prefers-color-scheme:light){.box[_ngcontent-%COMP%]{--border-color:#535353;--highlight-color-valid:#5e5e5e}.send-btn[_ngcontent-%COMP%]{color:#202225}.topContent[_ngcontent-%COMP%]{background-color:#fff}.mainCard[_ngcontent-%COMP%], .replyCard[_ngcontent-%COMP%]{box-shadow:5px 5px 15px 5px hsla(0,0%,66.7%,.41)}ion-list[_ngcontent-%COMP%]{width:100%;background-color:#e6e6e6}.botContent[_ngcontent-%COMP%]{--background:#e6e6e6}ion-input[_ngcontent-%COMP%]{background-color:#ddd;border-radius:25px;color:#222;font-weight:400;font-size:medium}ion-item.sc-ion-input-md-h[_ngcontent-%COMP%]:not(.item-label), ion-item[_ngcontent-%COMP%]:not(.item-label)   .sc-ion-input-md-h[_ngcontent-%COMP%]{--padding-start:15px;--padding-end:15px}}@media (prefers-color-scheme:dark){.box[_ngcontent-%COMP%]{--border-color:#fff;--highlight-color-valid:#50c8ff;margin:1px;border:thin solid #403e39;border-radius:25px}.send-btn[_ngcontent-%COMP%]{color:#50c8ff}.topContent[_ngcontent-%COMP%]{background-image:url(/assets/img/mapblurDark.jpg);border-bottom:2px solid #403e39;background-color:#2f3237}ion-card[_ngcontent-%COMP%]{box-shadow:2px 2px 17px 4px rgba(0,0,0,.41)}ion-list[_ngcontent-%COMP%]{width:100%;background-color:#202225}.botContent[_ngcontent-%COMP%]{--background:#202225}ion-input[_ngcontent-%COMP%]{color:#bcbbbe;font-weight:400;font-size:medium;--highlight-background:purple}}@media only screen and (max-height:824px){.topContent[_ngcontent-%COMP%]{height:79%}.mainRow[_ngcontent-%COMP%]{height:9em}}@media only screen and (max-height:812px){.topContent[_ngcontent-%COMP%]{height:79%}.mainRow[_ngcontent-%COMP%]{height:7em}}@media only screen and (max-height:740px){.topContent[_ngcontent-%COMP%]{height:70%}.mainRow[_ngcontent-%COMP%]{height:6em}}@media only screen and (max-height:738px){.topContent[_ngcontent-%COMP%]{height:75%}.mainRow[_ngcontent-%COMP%]{height:6em}}@media only screen and (max-height:732px){.topContent[_ngcontent-%COMP%]{height:78%}.mainRow[_ngcontent-%COMP%]{height:8em}}@media only screen and (max-height:668px){.topContent[_ngcontent-%COMP%]{height:79%}.mainRow[_ngcontent-%COMP%]{height:7em}}@media only screen and (max-height:641px){.topContent[_ngcontent-%COMP%]{height:76%}.mainRow[_ngcontent-%COMP%]{height:7em}}@media only screen and (max-height:569px){.topContent[_ngcontent-%COMP%]{height:77%}.mainRow[_ngcontent-%COMP%]{height:6em}}\"]}),CommentsPage})()}];let comments_routing_module_CommentsPageRoutingModule=(()=>{class CommentsPageRoutingModule{}return CommentsPageRoutingModule.ɵmod=core.Fb({type:CommentsPageRoutingModule}),CommentsPageRoutingModule.ɵinj=core.Eb({factory:function(t){return new(t||CommentsPageRoutingModule)},imports:[[router.i.forChild(routes)],router.i]}),CommentsPageRoutingModule})();var component_module=__webpack_require__(\"nETc\");let comments_module_CommentsPageModule=(()=>{class CommentsPageModule{}return CommentsPageModule.ɵmod=core.Fb({type:CommentsPageModule}),CommentsPageModule.ɵinj=core.Eb({factory:function(t){return new(t||CommentsPageModule)},imports:[[common.c,fesm2015_forms.a,ionic_angular.C,comments_routing_module_CommentsPageRoutingModule,component_module.a]]}),CommentsPageModule})()}}]);","extractedComments":[]}