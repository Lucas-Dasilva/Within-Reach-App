{"code":"(window.webpackJsonp=window.webpackJsonp||[]).push([[14],{\"99Un\":function(module,__webpack_exports__,__webpack_require__){\"use strict\";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,\"HomePageModule\",(function(){return home_module_HomePageModule}));var common=__webpack_require__(\"ofXK\"),fesm2015_forms=__webpack_require__(\"3Pt+\"),ionic_angular=__webpack_require__(\"TEn/\"),fesm2015_router=__webpack_require__(\"tyNb\"),tslib_es6=__webpack_require__(\"mrSG\"),create_post_page=__webpack_require__(\"4WUr\"),BehaviorSubject=__webpack_require__(\"2Vo4\"),switchMap=__webpack_require__(\"eIep\"),Subject=__webpack_require__(\"XNiG\"),core=__webpack_require__(\"fXoL\"),location_service=__webpack_require__(\"yHma\"),get_data_service=__webpack_require__(\"EQNs\"),post_data_service=__webpack_require__(\"2ZZ0\"),user_service=__webpack_require__(\"qfBg\"),vote_button_component=__webpack_require__(\"/Hhz\"),humanize_pipe=__webpack_require__(\"Wu1i\");const _c0=[\"karmaCard\"];function HomePage_ion_chip_2_Template(rf,ctx){if(1&rf){const _r5=core.Lb();core.Kb(0,\"ion-chip\",14),core.Sb(\"click\",(function(){return core.dc(_r5),core.Ub().karmaChipAnimation()})),core.Kb(1,\"ion-label\"),core.jc(2),core.Jb(),core.Jb()}if(2&rf){const user_r3=ctx.ngIf;core.xb(2),core.kc(user_r3.karma)}}function HomePage_ion_list_19_ion_card_1_ion_col_13_Template(rf,ctx){if(1&rf){const _r14=core.Lb();core.Kb(0,\"ion-col\",24),core.Sb(\"click\",(function(){core.dc(_r14);const post_r8=core.Ub().$implicit;return core.Ub(2).gotToComments(post_r8.id)})),core.Ib(1,\"ion-icon\",25),core.Kb(2,\"div\",23),core.jc(3,\"none\"),core.Jb(),core.Jb()}}function HomePage_ion_list_19_ion_card_1_ion_col_14_Template(rf,ctx){if(1&rf){const _r17=core.Lb();core.Kb(0,\"ion-col\",24),core.Sb(\"click\",(function(){core.dc(_r17);const post_r8=core.Ub().$implicit;return core.Ub(2).gotToComments(post_r8.id)})),core.Ib(1,\"ion-icon\",25),core.Kb(2,\"div\",23),core.jc(3,\"1 reply\"),core.Jb(),core.Jb()}}function HomePage_ion_list_19_ion_card_1_ion_col_15_Template(rf,ctx){if(1&rf){const _r20=core.Lb();core.Kb(0,\"ion-col\",24),core.Sb(\"click\",(function(){core.dc(_r20);const post_r8=core.Ub().$implicit;return core.Ub(2).gotToComments(post_r8.id)})),core.Ib(1,\"ion-icon\",26),core.Kb(2,\"div\",23),core.jc(3),core.Jb(),core.Jb()}if(2&rf){const post_r8=core.Ub().$implicit;core.xb(3),core.lc(\"\",post_r8.reply_count,\" replies\")}}function HomePage_ion_list_19_ion_card_1_Template(rf,ctx){if(1&rf){const _r23=core.Lb();core.Kb(0,\"ion-card\"),core.Kb(1,\"ion-row\"),core.Kb(2,\"ion-col\",16),core.Sb(\"click\",(function(){core.dc(_r23);const post_r8=ctx.$implicit;return core.Ub(2).gotToComments(post_r8.id)})),core.jc(3),core.Jb(),core.Kb(4,\"ion-col\",17),core.Ib(5,\"app-vote-button\",18),core.Jb(),core.Jb(),core.Kb(6,\"ion-footer\",1),core.Kb(7,\"ion-grid\"),core.Kb(8,\"ion-row\"),core.Kb(9,\"ion-col\",19),core.Ib(10,\"ion-icon\",20),core.jc(11),core.Vb(12,\"datepipe\"),core.Jb(),core.hc(13,HomePage_ion_list_19_ion_card_1_ion_col_13_Template,4,0,\"ion-col\",21),core.hc(14,HomePage_ion_list_19_ion_card_1_ion_col_14_Template,4,0,\"ion-col\",21),core.hc(15,HomePage_ion_list_19_ion_card_1_ion_col_15_Template,4,1,\"ion-col\",21),core.Kb(16,\"ion-col\",22),core.Kb(17,\"div\",23),core.jc(18),core.Jb(),core.Jb(),core.Jb(),core.Jb(),core.Jb(),core.Jb()}if(2&rf){const post_r8=ctx.$implicit,posts_r6=core.Ub().ngIf;core.xb(3),core.lc(\" \",post_r8.body,\" \"),core.xb(2),core.Zb(\"reactions\",posts_r6.react_list)(\"post_id\",post_r8.id)(\"post_user\",post_r8.user_id)(\"likes\",post_r8.likes),core.xb(6),core.lc(\" \",core.Wb(12,10,post_r8.timestamp),\" \"),core.xb(2),core.Zb(\"ngIf\",0==post_r8.reply_count),core.xb(1),core.Zb(\"ngIf\",1==post_r8.reply_count),core.xb(1),core.Zb(\"ngIf\",post_r8.reply_count>1),core.xb(3),core.lc(\" \",post_r8.distance,\" miles\")}}function HomePage_ion_list_19_Template(rf,ctx){if(1&rf&&(core.Kb(0,\"ion-list\",1),core.hc(1,HomePage_ion_list_19_ion_card_1_Template,19,12,\"ion-card\",15),core.Jb()),2&rf){const posts_r6=ctx.ngIf;core.xb(1),core.Zb(\"ngForOf\",posts_r6.post_list)}}const routes=[{path:\"\",component:(()=>{class HomePage{constructor(location,animationCtrl,getData,modalCtrl,postData,nav,router,user){this.location=location,this.animationCtrl=animationCtrl,this.getData=getData,this.modalCtrl=modalCtrl,this.postData=postData,this.nav=nav,this.router=router,this.user=user,this.stopPolling=new Subject.a,this.refresh$=new BehaviorSubject.a(!0)}ngOnInit(){return Object(tslib_es6.a)(this,void 0,void 0,(function*(){try{yield this.user.userInfo(),yield this.location.getCoords(),this.user_id=this.user.uuid}catch(_a){this.nav.navigateRoot(\"error\")}this.card=this.karmaCard.el,this.setupFlipAnimation()}))}ionViewWillEnter(){this.userLat=this.location.currentLocation.latitude,this.userLon=this.location.currentLocation.longitude;try{this.user$=this.refresh$.pipe(Object(switchMap.a)(_=>this.getData.getUser(this.user.uuid)))}catch(_a){this.nav.navigateRoot(\"error\")}this.posts$=this.refresh$.pipe(Object(switchMap.a)(_=>this.getData.getPosts(this.userLat,this.userLon,this.user.uuid)))}doRefresh($event){return Object(tslib_es6.a)(this,void 0,void 0,(function*(){setTimeout(()=>{this.refresh$.next(!0),$event.target.complete()},250)}))}sortPosts(event){\"hot\"==event.target.value?this.posts$=this.refresh$.pipe(Object(switchMap.a)(_=>this.getData.getPostsSorted(this.userLat,this.userLon,this.user_id))):\"new\"==event.target.value&&(this.posts$=this.refresh$.pipe(Object(switchMap.a)(_=>this.getData.getPosts(this.userLat,this.userLon,this.user_id))))}createPost(){return Object(tslib_es6.a)(this,void 0,void 0,(function*(){let postModal=yield this.modalCtrl.create({component:create_post_page.a});yield postModal.present(),postModal.onDidDismiss().then(data=>{null!=data.data&&(this.userLat=this.location.currentLocation.latitude,this.userLon=this.location.currentLocation.longitude,this.postData.createPostRequest(this.userLat,this.userLon,this.user_id,data.data.postBod).then(()=>{this.refresh$.next(!0)}))})}))}gotToComments(post_id){let navigationExtras={queryParams:{post_id:JSON.stringify(post_id)}};this.router.navigate([\"comments\"],navigationExtras)}ngOnDestroy(){this.stopPolling.next()}setupFlipAnimation(){const flip=this.animationCtrl.create(\"flip\").addElement(this.card).duration(300).keyframes([{offset:0,transform:\"rotateX(0)\",opacity:0},{offset:1,transform:\"rotateX(-180deg)\",opacity:1}]),slide=this.animationCtrl.create(\"slide\").addElement(this.card).duration(300).keyframes([{offset:0,transform:\"translateY(-800px) translateX(-1000px)\",opacity:0},{offset:1,transform:\"translateY(0) translateX(0)\",opacity:1}]);this.flipAnimation=this.animationCtrl.create(\"flip-animation\").duration(400).easing(\"ease-out\").addAnimation([flip,slide])}karmaChipAnimation(){this.flipAnimation.play()}}return HomePage.ɵfac=function(t){return new(t||HomePage)(core.Hb(location_service.a),core.Hb(ionic_angular.b),core.Hb(get_data_service.a),core.Hb(ionic_angular.F),core.Hb(post_data_service.a),core.Hb(ionic_angular.G),core.Hb(fesm2015_router.g),core.Hb(user_service.a))},HomePage.ɵcmp=core.Bb({type:HomePage,selectors:[[\"app-home\"]],viewQuery:function(rf,ctx){var _t;1&rf&&core.mc(_c0,!0),2&rf&&core.bc(_t=core.Tb())&&(ctx.karmaCard=_t.first)},decls:21,vars:7,consts:[[3,\"translucent\"],[\"mode\",\"ios\"],[\"lines\",\"none\",\"slot\",\"start\",3,\"click\",4,\"ngIf\"],[\"mode\",\"ios\",\"value\",\"new\",3,\"ionChange\"],[\"value\",\"new\"],[\"value\",\"hot\"],[\"slot\",\"end\"],[3,\"click\"],[\"name\",\"create-outline\"],[\"id\",\"karmaCard\"],[\"karmaCard\",\"\"],[\"slot\",\"fixed\",3,\"ionRefresh\"],[\"pullingIcon\",\"circular\"],[\"mode\",\"ios\",4,\"ngIf\"],[\"lines\",\"none\",\"slot\",\"start\",3,\"click\"],[4,\"ngFor\",\"ngForOf\"],[\"size\",\"10\",1,\"body\",3,\"click\"],[\"size\",\"2\",1,\"vote\"],[3,\"reactions\",\"post_id\",\"post_user\",\"likes\"],[\"size\",\"4\",1,\"time\"],[\"name\",\"time-outline\"],[\"size\",\"4\",\"class\",\"reply\",3,\"click\",4,\"ngIf\"],[\"size\",\"4\",1,\"distance\"],[1,\"text\"],[\"size\",\"4\",1,\"reply\",3,\"click\"],[\"name\",\"chatbubble-outline\"],[\"name\",\"chatbubbles-outline\"]],template:function(rf,ctx){1&rf&&(core.Kb(0,\"ion-header\",0),core.Kb(1,\"ion-toolbar\",1),core.hc(2,HomePage_ion_chip_2_Template,3,1,\"ion-chip\",2),core.Vb(3,\"async\"),core.Kb(4,\"ion-segment\",3),core.Sb(\"ionChange\",(function($event){return ctx.sortPosts($event)})),core.Kb(5,\"ion-segment-button\",4),core.Kb(6,\"ion-label\"),core.jc(7,\"New\"),core.Jb(),core.Jb(),core.Kb(8,\"ion-segment-button\",5),core.Kb(9,\"ion-label\"),core.jc(10,\"Hot\"),core.Jb(),core.Jb(),core.Jb(),core.Kb(11,\"ion-buttons\",6),core.Kb(12,\"ion-button\",7),core.Sb(\"click\",(function(){return ctx.createPost()})),core.Ib(13,\"ion-icon\",8),core.Jb(),core.Jb(),core.Jb(),core.Jb(),core.Kb(14,\"ion-content\"),core.Ib(15,\"ion-card\",9,10),core.Kb(17,\"ion-refresher\",11),core.Sb(\"ionRefresh\",(function($event){return ctx.doRefresh($event)})),core.Ib(18,\"ion-refresher-content\",12),core.Jb(),core.hc(19,HomePage_ion_list_19_Template,2,1,\"ion-list\",13),core.Vb(20,\"async\"),core.Jb()),2&rf&&(core.Zb(\"translucent\",!0),core.xb(2),core.Zb(\"ngIf\",core.Wb(3,3,ctx.user$)),core.xb(17),core.Zb(\"ngIf\",core.Wb(20,5,ctx.posts$)))},directives:[ionic_angular.n,ionic_angular.B,common.k,ionic_angular.x,ionic_angular.I,ionic_angular.y,ionic_angular.r,ionic_angular.g,ionic_angular.f,ionic_angular.o,ionic_angular.k,ionic_angular.h,ionic_angular.t,ionic_angular.u,ionic_angular.i,ionic_angular.s,common.j,ionic_angular.w,ionic_angular.j,vote_button_component.a,ionic_angular.l,ionic_angular.m],pipes:[common.b,humanize_pipe.a],styles:[\"ion-footer[_ngcontent-%COMP%]{display:inline;margin:auto}ion-chip[_ngcontent-%COMP%], ion-refresher[_ngcontent-%COMP%]{--color:#5600f7}ion-chip[_ngcontent-%COMP%]{--background:#fff}ion-label[_ngcontent-%COMP%]{font-weight:700}ion-button[_ngcontent-%COMP%]{--color:#5600f7}ion-icon[_ngcontent-%COMP%]{vertical-align:middle;padding-bottom:3.5px}#karmaCard[_ngcontent-%COMP%]{display:none;width:100px;height:100px;background:rgba(0,0,255,.5);margin:10px}.time[_ngcontent-%COMP%]{padding-left:4px}.distance[_ngcontent-%COMP%], .time[_ngcontent-%COMP%]{font-size:13px;padding-top:1em;color:#7972da}.distance[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;margin:auto;padding-right:4px}.vote[_ngcontent-%COMP%]{display:flex;padding-bottom:0;align-items:center}.reply[_ngcontent-%COMP%]{font-size:13px;justify-content:center;padding-top:1em;display:flex}.text[_ngcontent-%COMP%]{margin-left:.5em}.body[_ngcontent-%COMP%]{padding:1em}@media (prefers-color-scheme:light){ion-card[_ngcontent-%COMP%]{box-shadow:5px 5px 15px 5px hsla(0,0%,66.7%,.41);--color:#5f656d}}@media (prefers-color-scheme:dark){ion-card[_ngcontent-%COMP%]{box-shadow:2px 2px 17px 4px rgba(0,0,0,.41)}}\"]}),HomePage})()}];let home_routing_module_HomePageRoutingModule=(()=>{class HomePageRoutingModule{}return HomePageRoutingModule.ɵmod=core.Fb({type:HomePageRoutingModule}),HomePageRoutingModule.ɵinj=core.Eb({factory:function(t){return new(t||HomePageRoutingModule)},imports:[[fesm2015_router.i.forChild(routes)],fesm2015_router.i]}),HomePageRoutingModule})();var component_module=__webpack_require__(\"nETc\");let home_module_HomePageModule=(()=>{class HomePageModule{}return HomePageModule.ɵmod=core.Fb({type:HomePageModule}),HomePageModule.ɵinj=core.Eb({factory:function(t){return new(t||HomePageModule)},imports:[[common.c,fesm2015_forms.a,ionic_angular.C,home_routing_module_HomePageRoutingModule,component_module.a]]}),HomePageModule})()}}]);","extractedComments":[]}