!function(){function t(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}function n(t,n){for(var e=0;e<n.length;e++){var o=n[e];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}(window.webpackJsonp=window.webpackJsonp||[]).push([[14],{"99Un":function(e,o,i){"use strict";i.r(o),i.d(o,"HomePageModule",(function(){return R}));var r=i("ofXK"),a=i("3Pt+"),s=i("TEn/"),c=i("tyNb"),u=i("mrSG"),l=i("4WUr"),b=i("2Vo4"),f=i("eIep"),d=i("XNiG"),p=i("fXoL"),m=i("yHma"),h=i("EQNs"),g=i("2ZZ0"),v=i("qfBg"),y=i("/Hhz"),x=i("Wu1i"),k=["karmaCard"];function C(t,n){if(1&t){var e=p.Lb();p.Kb(0,"ion-chip",14),p.Sb("click",(function(){return p.dc(e),p.Ub().presentToast()})),p.Kb(1,"ion-label"),p.jc(2),p.Jb(),p.Jb()}if(2&t){var o=n.ngIf;p.xb(2),p.kc(o.karma)}}function w(t,n){if(1&t){var e=p.Lb();p.Kb(0,"ion-col",24),p.Sb("click",(function(){p.dc(e);var t=p.Ub().$implicit;return p.Ub(2).gotToComments(t.id)})),p.Ib(1,"ion-icon",25),p.Kb(2,"div",23),p.jc(3,"none"),p.Jb(),p.Jb()}}function _(t,n){if(1&t){var e=p.Lb();p.Kb(0,"ion-col",24),p.Sb("click",(function(){p.dc(e);var t=p.Ub().$implicit;return p.Ub(2).gotToComments(t.id)})),p.Ib(1,"ion-icon",25),p.Kb(2,"div",23),p.jc(3,"1 reply"),p.Jb(),p.Jb()}}function J(t,n){if(1&t){var e=p.Lb();p.Kb(0,"ion-col",24),p.Sb("click",(function(){p.dc(e);var t=p.Ub().$implicit;return p.Ub(2).gotToComments(t.id)})),p.Ib(1,"ion-icon",26),p.Kb(2,"div",23),p.jc(3),p.Jb(),p.Jb()}if(2&t){var o=p.Ub().$implicit;p.xb(3),p.lc("",o.reply_count," replies")}}function K(t,n){if(1&t){var e=p.Lb();p.Kb(0,"ion-card"),p.Kb(1,"ion-row"),p.Kb(2,"ion-col",16),p.Sb("click",(function(){p.dc(e);var t=n.$implicit;return p.Ub(2).gotToComments(t.id)})),p.jc(3),p.Jb(),p.Kb(4,"ion-col",17),p.Ib(5,"app-vote-button",18),p.Jb(),p.Jb(),p.Kb(6,"ion-footer",1),p.Kb(7,"ion-grid"),p.Kb(8,"ion-row"),p.Kb(9,"ion-col",19),p.Ib(10,"ion-icon",20),p.jc(11),p.Vb(12,"datepipe"),p.Jb(),p.hc(13,w,4,0,"ion-col",21),p.hc(14,_,4,0,"ion-col",21),p.hc(15,J,4,1,"ion-col",21),p.Kb(16,"ion-col",22),p.Kb(17,"div",23),p.jc(18),p.Jb(),p.Jb(),p.Jb(),p.Jb(),p.Jb(),p.Jb()}if(2&t){var o=n.$implicit,i=p.Ub().ngIf;p.xb(3),p.lc(" ",o.body," "),p.xb(2),p.Zb("reactions",i.react_list)("post_id",o.id)("post_user",o.user_id)("likes",o.likes),p.xb(6),p.lc(" ",p.Wb(12,10,o.timestamp)," "),p.xb(2),p.Zb("ngIf",0==o.reply_count),p.xb(1),p.Zb("ngIf",1==o.reply_count),p.xb(1),p.Zb("ngIf",o.reply_count>1),p.xb(3),p.lc(" ",o.distance," miles")}}function O(t,n){if(1&t&&(p.Kb(0,"ion-list",1),p.hc(1,K,19,12,"ion-card",15),p.Jb()),2&t){var e=n.ngIf;p.xb(1),p.Zb("ngForOf",e.post_list)}}var P,L,j,I=[{path:"",component:(P=function(){function e(n,o,i,r,a,s,c,u,l){t(this,e),this.location=n,this.toastController=o,this.animationCtrl=i,this.getData=r,this.modalCtrl=a,this.postData=s,this.nav=c,this.router=u,this.user=l,this.stopPolling=new d.a,this.refresh$=new b.a(!0)}var o,i,r;return o=e,(i=[{key:"ngOnInit",value:function(){return Object(u.a)(this,void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,this.user.userInfo();case 3:return t.next=5,this.location.getCoords();case 5:this.user_id=this.user.uuid,t.next=11;break;case 8:t.prev=8,t.t0=t.catch(0),this.nav.navigateRoot("location");case 11:case"end":return t.stop()}}),t,this,[[0,8]])})))}},{key:"ionViewWillEnter",value:function(){var t=this;console.log("Entered"),this.location.getCoords().then((function(n){t.userLat=n.latitude,t.userLon=n.longitude,t.user$=t.refresh$.pipe(Object(f.a)((function(n){return t.getData.getUser(t.user.uuid)}))),t.posts$=t.refresh$.pipe(Object(f.a)((function(){return t.getData.getPosts(t.userLat,t.userLon,t.user.uuid)})))}))}},{key:"doRefresh",value:function(t){return Object(u.a)(this,void 0,void 0,regeneratorRuntime.mark((function n(){var e=this;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:this.location.getCoords().then((function(n){e.userLat=n.latitude,e.userLon=n.longitude,e.refresh$.next(!0),setTimeout((function(){console.log("timeout"),t.target.complete()}),500)}));case 1:case"end":return n.stop()}}),n,this)})))}},{key:"sortPosts",value:function(t){var n=this;"hot"==t.target.value?this.posts$=this.refresh$.pipe(Object(f.a)((function(t){return n.getData.getPostsSorted(n.userLat,n.userLon,n.user_id)}))):"new"==t.target.value&&(this.posts$=this.refresh$.pipe(Object(f.a)((function(t){return n.getData.getPosts(n.userLat,n.userLon,n.user_id)}))))}},{key:"createPost",value:function(){return Object(u.a)(this,void 0,void 0,regeneratorRuntime.mark((function t(){var n,e=this;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.modalCtrl.create({component:l.a});case 2:return n=t.sent,t.next=5,n.present();case 5:n.onDidDismiss().then((function(t){null!=t.data&&(e.userLat=e.location.currentLocation.latitude,e.userLon=e.location.currentLocation.longitude,e.postData.createPostRequest(e.userLat,e.userLon,e.user_id,t.data.postBod).then((function(){e.refresh$.next(!0)})))}));case 6:case"end":return t.stop()}}),t,this)})))}},{key:"gotToComments",value:function(t){var n={queryParams:{post_id:JSON.stringify(t)}};this.router.navigate(["comments"],n)}},{key:"ngOnDestroy",value:function(){this.stopPolling.next()}},{key:"setupFlipAnimation",value:function(){var t=this.animationCtrl.create("flip").addElement(this.card).duration(300).keyframes([{offset:0,transform:"rotateX(0)",opacity:0},{offset:1,transform:"rotateX(-180deg)",opacity:1}]),n=this.animationCtrl.create("slide").addElement(this.card).duration(300).keyframes([{offset:0,transform:"translateY(-800px) translateX(-1000px)",opacity:0},{offset:1,transform:"translateY(0) translateX(0)",opacity:1}]);this.flipAnimation=this.animationCtrl.create("flip-animation").duration(400).easing("ease-out").addAnimation([t,n])}},{key:"presentToast",value:function(){return Object(u.a)(this,void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.toastController.create({message:"Your Location: ("+this.userLat+"), ("+this.userLon+")",duration:2e3});case 2:t.sent.present();case 3:case"end":return t.stop()}}),t,this)})))}},{key:"karmaChipAnimation",value:function(){this.flipAnimation.play()}}])&&n(o.prototype,i),r&&n(o,r),e}(),P.\u0275fac=function(t){return new(t||P)(p.Hb(m.a),p.Hb(s.K),p.Hb(s.b),p.Hb(h.a),p.Hb(s.F),p.Hb(g.a),p.Hb(s.G),p.Hb(c.g),p.Hb(v.a))},P.\u0275cmp=p.Bb({type:P,selectors:[["app-home"]],viewQuery:function(t,n){var e;1&t&&p.mc(k,!0),2&t&&p.bc(e=p.Tb())&&(n.karmaCard=e.first)},decls:21,vars:7,consts:[[3,"translucent"],["mode","ios"],["lines","none","slot","start",3,"click",4,"ngIf"],["mode","ios","value","new",3,"ionChange"],["value","new"],["value","hot"],["slot","end"],[3,"click"],["name","create-outline"],["id","karmaCard"],["karmaCard",""],["slot","fixed",3,"ionRefresh"],["pullingIcon","circular"],["mode","ios",4,"ngIf"],["lines","none","slot","start",3,"click"],[4,"ngFor","ngForOf"],["size","10",1,"body",3,"click"],["size","2",1,"vote"],[3,"reactions","post_id","post_user","likes"],["size","4",1,"time"],["name","time-outline"],["size","4","class","reply",3,"click",4,"ngIf"],["size","4",1,"distance"],[1,"text"],["size","4",1,"reply",3,"click"],["name","chatbubble-outline"],["name","chatbubbles-outline"]],template:function(t,n){1&t&&(p.Kb(0,"ion-header",0),p.Kb(1,"ion-toolbar",1),p.hc(2,C,3,1,"ion-chip",2),p.Vb(3,"async"),p.Kb(4,"ion-segment",3),p.Sb("ionChange",(function(t){return n.sortPosts(t)})),p.Kb(5,"ion-segment-button",4),p.Kb(6,"ion-label"),p.jc(7,"New"),p.Jb(),p.Jb(),p.Kb(8,"ion-segment-button",5),p.Kb(9,"ion-label"),p.jc(10,"Hot"),p.Jb(),p.Jb(),p.Jb(),p.Kb(11,"ion-buttons",6),p.Kb(12,"ion-button",7),p.Sb("click",(function(){return n.createPost()})),p.Ib(13,"ion-icon",8),p.Jb(),p.Jb(),p.Jb(),p.Jb(),p.Kb(14,"ion-content"),p.Ib(15,"ion-card",9,10),p.Kb(17,"ion-refresher",11),p.Sb("ionRefresh",(function(t){return n.doRefresh(t)})),p.Ib(18,"ion-refresher-content",12),p.Jb(),p.hc(19,O,2,1,"ion-list",13),p.Vb(20,"async"),p.Jb()),2&t&&(p.Zb("translucent",!0),p.xb(2),p.Zb("ngIf",p.Wb(3,3,n.user$)),p.xb(17),p.Zb("ngIf",p.Wb(20,5,n.posts$)))},directives:[s.n,s.B,r.k,s.x,s.I,s.y,s.r,s.g,s.f,s.o,s.k,s.h,s.t,s.u,s.i,s.s,r.j,s.w,s.j,y.a,s.l,s.m],pipes:[r.b,x.a],styles:["ion-footer[_ngcontent-%COMP%]{display:inline;margin:auto}ion-chip[_ngcontent-%COMP%], ion-refresher[_ngcontent-%COMP%]{--color:#5600f7}ion-chip[_ngcontent-%COMP%]{--background:#fff}ion-label[_ngcontent-%COMP%]{font-weight:700}ion-button[_ngcontent-%COMP%]{--color:#5600f7}ion-icon[_ngcontent-%COMP%]{vertical-align:middle;padding-bottom:3.5px}#karmaCard[_ngcontent-%COMP%]{display:none;width:100px;height:100px;background:rgba(0,0,255,.5);margin:10px}.time[_ngcontent-%COMP%]{padding-left:4px}.distance[_ngcontent-%COMP%], .time[_ngcontent-%COMP%]{font-size:13px;padding-top:1em;color:#7972da}.distance[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;margin:auto;padding-right:4px}.vote[_ngcontent-%COMP%]{display:flex;padding-bottom:0;align-items:center}.reply[_ngcontent-%COMP%]{font-size:13px;justify-content:center;padding-top:1em;display:flex}.text[_ngcontent-%COMP%]{margin-left:.5em}.body[_ngcontent-%COMP%]{padding:1em}@media (prefers-color-scheme:light){ion-card[_ngcontent-%COMP%]{box-shadow:5px 5px 15px 5px hsla(0,0%,66.7%,.41);--color:#5f656d}}@media (prefers-color-scheme:dark){ion-card[_ngcontent-%COMP%]{box-shadow:2px 2px 17px 4px rgba(0,0,0,.41)}}"]}),P)}],M=((L=function n(){t(this,n)}).\u0275mod=p.Fb({type:L}),L.\u0275inj=p.Eb({factory:function(t){return new(t||L)},imports:[[c.i.forChild(I)],c.i]}),L),$=i("nETc"),R=((j=function n(){t(this,n)}).\u0275mod=p.Fb({type:j}),j.\u0275inj=p.Eb({factory:function(t){return new(t||j)},imports:[[r.c,a.a,s.C,M,$.a]]}),j)}}])}();