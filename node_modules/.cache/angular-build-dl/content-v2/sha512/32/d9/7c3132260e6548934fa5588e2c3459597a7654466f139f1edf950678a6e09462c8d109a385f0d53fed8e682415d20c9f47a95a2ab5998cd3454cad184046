!function(){function t(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}function n(t,n){for(var e=0;e<n.length;e++){var i=n[e];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}(window.webpackJsonp=window.webpackJsonp||[]).push([[14],{"99Un":function(e,i,o){"use strict";o.r(i),o.d(i,"HomePageModule",(function(){return U}));var r=o("ofXK"),a=o("3Pt+"),c=o("TEn/"),s=o("tyNb"),u=o("mrSG"),b=o("4WUr"),l=o("2Vo4"),f=o("eIep"),p=o("XNiG"),d=o("fXoL"),m=o("yHma"),h=o("EQNs"),g=o("2ZZ0"),v=o("qfBg"),y=o("/Hhz"),x=o("Wu1i"),k=["karmaCard"];function C(t,n){if(1&t){var e=d.Lb();d.Kb(0,"ion-chip",14),d.Sb("click",(function(){return d.dc(e),d.Ub().karmaChipAnimation()})),d.Kb(1,"ion-label"),d.jc(2),d.Jb(),d.Jb()}if(2&t){var i=n.ngIf;d.xb(2),d.kc(i.karma)}}function w(t,n){if(1&t){var e=d.Lb();d.Kb(0,"ion-col",24),d.Sb("click",(function(){d.dc(e);var t=d.Ub().$implicit;return d.Ub(2).gotToComments(t.id)})),d.Ib(1,"ion-icon",25),d.Kb(2,"div",23),d.jc(3,"none"),d.Jb(),d.Jb()}}function _(t,n){if(1&t){var e=d.Lb();d.Kb(0,"ion-col",24),d.Sb("click",(function(){d.dc(e);var t=d.Ub().$implicit;return d.Ub(2).gotToComments(t.id)})),d.Ib(1,"ion-icon",25),d.Kb(2,"div",23),d.jc(3,"1 reply"),d.Jb(),d.Jb()}}function J(t,n){if(1&t){var e=d.Lb();d.Kb(0,"ion-col",24),d.Sb("click",(function(){d.dc(e);var t=d.Ub().$implicit;return d.Ub(2).gotToComments(t.id)})),d.Ib(1,"ion-icon",26),d.Kb(2,"div",23),d.jc(3),d.Jb(),d.Jb()}if(2&t){var i=d.Ub().$implicit;d.xb(3),d.lc("",i.reply_count," replies")}}function P(t,n){if(1&t){var e=d.Lb();d.Kb(0,"ion-card"),d.Kb(1,"ion-row"),d.Kb(2,"ion-col",16),d.Sb("click",(function(){d.dc(e);var t=n.$implicit;return d.Ub(2).gotToComments(t.id)})),d.jc(3),d.Jb(),d.Kb(4,"ion-col",17),d.Ib(5,"app-vote-button",18),d.Jb(),d.Jb(),d.Kb(6,"ion-footer",1),d.Kb(7,"ion-grid"),d.Kb(8,"ion-row"),d.Kb(9,"ion-col",19),d.Ib(10,"ion-icon",20),d.jc(11),d.Vb(12,"datepipe"),d.Jb(),d.hc(13,w,4,0,"ion-col",21),d.hc(14,_,4,0,"ion-col",21),d.hc(15,J,4,1,"ion-col",21),d.Kb(16,"ion-col",22),d.Kb(17,"div",23),d.jc(18),d.Jb(),d.Jb(),d.Jb(),d.Jb(),d.Jb(),d.Jb()}if(2&t){var i=n.$implicit,o=d.Ub().ngIf;d.xb(3),d.lc(" ",i.body," "),d.xb(2),d.Zb("reactions",o.react_list)("post_id",i.id)("post_user",i.user_id)("likes",i.likes),d.xb(6),d.lc(" ",d.Wb(12,10,i.timestamp)," "),d.xb(2),d.Zb("ngIf",0==i.reply_count),d.xb(1),d.Zb("ngIf",1==i.reply_count),d.xb(1),d.Zb("ngIf",i.reply_count>1),d.xb(3),d.lc(" ",i.distance," miles")}}function K(t,n){if(1&t&&(d.Kb(0,"ion-list",1),d.hc(1,P,19,12,"ion-card",15),d.Jb()),2&t){var e=n.ngIf;d.xb(1),d.Zb("ngForOf",e.post_list)}}var O,I,j,L=[{path:"",component:(O=function(){function e(n,i,o,r,a,c,s,u){t(this,e),this.location=n,this.animationCtrl=i,this.getData=o,this.modalCtrl=r,this.postData=a,this.nav=c,this.router=s,this.user=u,this.stopPolling=new p.a,this.refresh$=new l.a(!0)}var i,o,r;return i=e,(o=[{key:"ngOnInit",value:function(){return Object(u.a)(this,void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,this.user.userInfo();case 3:return t.next=5,this.location.getCoords();case 5:this.user_id=this.user.uuid,t.next=11;break;case 8:t.prev=8,t.t0=t.catch(0),this.nav.navigateRoot("location");case 11:this.ionViewWillEnter();case 12:case"end":return t.stop()}}),t,this,[[0,8]])})))}},{key:"ionViewWillEnter",value:function(){var t=this;this.userLat=this.location.currentLocation.latitude,this.userLon=this.location.currentLocation.longitude,this.user$=this.refresh$.pipe(Object(f.a)((function(n){return t.getData.getUser(t.user.uuid)}))),this.posts$=this.refresh$.pipe(Object(f.a)((function(){return t.getData.getPosts(t.userLat,t.userLon,t.user.uuid)})))}},{key:"doRefresh",value:function(t){return Object(u.a)(this,void 0,void 0,regeneratorRuntime.mark((function n(){var e=this;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:setTimeout((function(){e.refresh$.next(!0),t.target.complete()}),250);case 1:case"end":return n.stop()}}),n)})))}},{key:"sortPosts",value:function(t){var n=this;"hot"==t.target.value?this.posts$=this.refresh$.pipe(Object(f.a)((function(t){return n.getData.getPostsSorted(n.userLat,n.userLon,n.user_id)}))):"new"==t.target.value&&(this.posts$=this.refresh$.pipe(Object(f.a)((function(t){return n.getData.getPosts(n.userLat,n.userLon,n.user_id)}))))}},{key:"createPost",value:function(){return Object(u.a)(this,void 0,void 0,regeneratorRuntime.mark((function t(){var n,e=this;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.modalCtrl.create({component:b.a});case 2:return n=t.sent,t.next=5,n.present();case 5:n.onDidDismiss().then((function(t){null!=t.data&&(e.userLat=e.location.currentLocation.latitude,e.userLon=e.location.currentLocation.longitude,e.postData.createPostRequest(e.userLat,e.userLon,e.user_id,t.data.postBod).then((function(){e.refresh$.next(!0)})))}));case 6:case"end":return t.stop()}}),t,this)})))}},{key:"gotToComments",value:function(t){var n={queryParams:{post_id:JSON.stringify(t)}};this.router.navigate(["comments"],n)}},{key:"ngOnDestroy",value:function(){this.stopPolling.next()}},{key:"setupFlipAnimation",value:function(){var t=this.animationCtrl.create("flip").addElement(this.card).duration(300).keyframes([{offset:0,transform:"rotateX(0)",opacity:0},{offset:1,transform:"rotateX(-180deg)",opacity:1}]),n=this.animationCtrl.create("slide").addElement(this.card).duration(300).keyframes([{offset:0,transform:"translateY(-800px) translateX(-1000px)",opacity:0},{offset:1,transform:"translateY(0) translateX(0)",opacity:1}]);this.flipAnimation=this.animationCtrl.create("flip-animation").duration(400).easing("ease-out").addAnimation([t,n])}},{key:"karmaChipAnimation",value:function(){this.flipAnimation.play()}}])&&n(i.prototype,o),r&&n(i,r),e}(),O.\u0275fac=function(t){return new(t||O)(d.Hb(m.a),d.Hb(c.b),d.Hb(h.a),d.Hb(c.F),d.Hb(g.a),d.Hb(c.G),d.Hb(s.g),d.Hb(v.a))},O.\u0275cmp=d.Bb({type:O,selectors:[["app-home"]],viewQuery:function(t,n){var e;1&t&&d.mc(k,!0),2&t&&d.bc(e=d.Tb())&&(n.karmaCard=e.first)},decls:21,vars:7,consts:[[3,"translucent"],["mode","ios"],["lines","none","slot","start",3,"click",4,"ngIf"],["mode","ios","value","new",3,"ionChange"],["value","new"],["value","hot"],["slot","end"],[3,"click"],["name","create-outline"],["id","karmaCard"],["karmaCard",""],["slot","fixed",3,"ionRefresh"],["pullingIcon","circular"],["mode","ios",4,"ngIf"],["lines","none","slot","start",3,"click"],[4,"ngFor","ngForOf"],["size","10",1,"body",3,"click"],["size","2",1,"vote"],[3,"reactions","post_id","post_user","likes"],["size","4",1,"time"],["name","time-outline"],["size","4","class","reply",3,"click",4,"ngIf"],["size","4",1,"distance"],[1,"text"],["size","4",1,"reply",3,"click"],["name","chatbubble-outline"],["name","chatbubbles-outline"]],template:function(t,n){1&t&&(d.Kb(0,"ion-header",0),d.Kb(1,"ion-toolbar",1),d.hc(2,C,3,1,"ion-chip",2),d.Vb(3,"async"),d.Kb(4,"ion-segment",3),d.Sb("ionChange",(function(t){return n.sortPosts(t)})),d.Kb(5,"ion-segment-button",4),d.Kb(6,"ion-label"),d.jc(7,"New"),d.Jb(),d.Jb(),d.Kb(8,"ion-segment-button",5),d.Kb(9,"ion-label"),d.jc(10,"Hot"),d.Jb(),d.Jb(),d.Jb(),d.Kb(11,"ion-buttons",6),d.Kb(12,"ion-button",7),d.Sb("click",(function(){return n.createPost()})),d.Ib(13,"ion-icon",8),d.Jb(),d.Jb(),d.Jb(),d.Jb(),d.Kb(14,"ion-content"),d.Ib(15,"ion-card",9,10),d.Kb(17,"ion-refresher",11),d.Sb("ionRefresh",(function(t){return n.doRefresh(t)})),d.Ib(18,"ion-refresher-content",12),d.Jb(),d.hc(19,K,2,1,"ion-list",13),d.Vb(20,"async"),d.Jb()),2&t&&(d.Zb("translucent",!0),d.xb(2),d.Zb("ngIf",d.Wb(3,3,n.user$)),d.xb(17),d.Zb("ngIf",d.Wb(20,5,n.posts$)))},directives:[c.n,c.B,r.k,c.x,c.I,c.y,c.r,c.g,c.f,c.o,c.k,c.h,c.t,c.u,c.i,c.s,r.j,c.w,c.j,y.a,c.l,c.m],pipes:[r.b,x.a],styles:["ion-footer[_ngcontent-%COMP%]{display:inline;margin:auto}ion-chip[_ngcontent-%COMP%], ion-refresher[_ngcontent-%COMP%]{--color:#5600f7}ion-chip[_ngcontent-%COMP%]{--background:#fff}ion-label[_ngcontent-%COMP%]{font-weight:700}ion-button[_ngcontent-%COMP%]{--color:#5600f7}ion-icon[_ngcontent-%COMP%]{vertical-align:middle;padding-bottom:3.5px}#karmaCard[_ngcontent-%COMP%]{display:none;width:100px;height:100px;background:rgba(0,0,255,.5);margin:10px}.time[_ngcontent-%COMP%]{padding-left:4px}.distance[_ngcontent-%COMP%], .time[_ngcontent-%COMP%]{font-size:13px;padding-top:1em;color:#7972da}.distance[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;margin:auto;padding-right:4px}.vote[_ngcontent-%COMP%]{display:flex;padding-bottom:0;align-items:center}.reply[_ngcontent-%COMP%]{font-size:13px;justify-content:center;padding-top:1em;display:flex}.text[_ngcontent-%COMP%]{margin-left:.5em}.body[_ngcontent-%COMP%]{padding:1em}@media (prefers-color-scheme:light){ion-card[_ngcontent-%COMP%]{box-shadow:5px 5px 15px 5px hsla(0,0%,66.7%,.41);--color:#5f656d}}@media (prefers-color-scheme:dark){ion-card[_ngcontent-%COMP%]{box-shadow:2px 2px 17px 4px rgba(0,0,0,.41)}}"]}),O)}],M=((I=function n(){t(this,n)}).\u0275mod=d.Fb({type:I}),I.\u0275inj=d.Eb({factory:function(t){return new(t||I)},imports:[[s.i.forChild(L)],s.i]}),I),$=o("nETc"),U=((j=function n(){t(this,n)}).\u0275mod=d.Fb({type:j}),j.\u0275inj=d.Eb({factory:function(t){return new(t||j)},imports:[[r.c,a.a,c.C,M,$.a]]}),j)}}])}();