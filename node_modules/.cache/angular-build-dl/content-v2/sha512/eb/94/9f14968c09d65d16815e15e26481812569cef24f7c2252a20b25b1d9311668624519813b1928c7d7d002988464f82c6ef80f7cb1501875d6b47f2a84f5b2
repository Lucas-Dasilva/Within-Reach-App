!function(){function t(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}function n(t,n){for(var e=0;e<n.length;e++){var o=n[e];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}(window.webpackJsonp=window.webpackJsonp||[]).push([[14],{"99Un":function(e,o,i){"use strict";i.r(o),i.d(o,"HomePageModule",(function(){return M}));var r=i("ofXK"),c=i("3Pt+"),s=i("TEn/"),a=i("tyNb"),u=i("mrSG"),b=i("4WUr"),l=i("2Vo4"),f=i("eIep"),p=i("XNiG"),d=i("fXoL"),h=i("yHma"),g=i("EQNs"),m=i("2ZZ0"),v=i("qfBg"),x=i("/Hhz"),y=i("Wu1i");function J(t,n){if(1&t&&(d.Kb(0,"ion-chip",12),d.Kb(1,"ion-label"),d.jc(2),d.Jb(),d.Jb()),2&t){var e=n.ngIf;d.xb(2),d.kc(e.karma)}}function _(t,n){if(1&t){var e=d.Lb();d.Kb(0,"ion-col",22),d.Sb("click",(function(){d.dc(e);var t=d.Ub().$implicit;return d.Ub(2).gotToComments(t.id)})),d.Ib(1,"ion-icon",23),d.Kb(2,"div",21),d.jc(3,"none"),d.Jb(),d.Jb()}}function k(t,n){if(1&t){var e=d.Lb();d.Kb(0,"ion-col",22),d.Sb("click",(function(){d.dc(e);var t=d.Ub().$implicit;return d.Ub(2).gotToComments(t.id)})),d.Ib(1,"ion-icon",23),d.Kb(2,"div",21),d.jc(3,"1 reply"),d.Jb(),d.Jb()}}function w(t,n){if(1&t){var e=d.Lb();d.Kb(0,"ion-col",22),d.Sb("click",(function(){d.dc(e);var t=d.Ub().$implicit;return d.Ub(2).gotToComments(t.id)})),d.Ib(1,"ion-icon",24),d.Kb(2,"div",21),d.jc(3),d.Jb(),d.Jb()}if(2&t){var o=d.Ub().$implicit;d.xb(3),d.lc("",o.reply_count," replies")}}function K(t,n){if(1&t){var e=d.Lb();d.Kb(0,"ion-card"),d.Kb(1,"ion-row"),d.Kb(2,"ion-col",14),d.Sb("click",(function(){d.dc(e);var t=n.$implicit;return d.Ub(2).gotToComments(t.id)})),d.jc(3),d.Jb(),d.Kb(4,"ion-col",15),d.Ib(5,"app-vote-button",16),d.Jb(),d.Jb(),d.Kb(6,"ion-footer",1),d.Kb(7,"ion-grid"),d.Kb(8,"ion-row"),d.Kb(9,"ion-col",17),d.Ib(10,"ion-icon",18),d.jc(11),d.Vb(12,"datepipe"),d.Jb(),d.hc(13,_,4,0,"ion-col",19),d.hc(14,k,4,0,"ion-col",19),d.hc(15,w,4,1,"ion-col",19),d.Kb(16,"ion-col",20),d.Kb(17,"div",21),d.jc(18),d.Jb(),d.Jb(),d.Jb(),d.Jb(),d.Jb(),d.Jb()}if(2&t){var o=n.$implicit,i=d.Ub().ngIf;d.xb(3),d.lc(" ",o.body," "),d.xb(2),d.Zb("reactions",i.react_list)("post_id",o.id)("post_user",o.user_id)("likes",o.likes),d.xb(6),d.lc(" ",d.Wb(12,10,o.timestamp)," "),d.xb(2),d.Zb("ngIf",0==o.reply_count),d.xb(1),d.Zb("ngIf",1==o.reply_count),d.xb(1),d.Zb("ngIf",o.reply_count>1),d.xb(3),d.lc(" ",o.distance," miles")}}function P(t,n){if(1&t&&(d.Kb(0,"ion-list",1),d.hc(1,K,19,12,"ion-card",13),d.Jb()),2&t){var e=n.ngIf;d.xb(1),d.Zb("ngForOf",e.post_list)}}var O,C,j,I=[{path:"",component:(O=function(){function e(n,o,i,r,c,s,a){t(this,e),this.location=n,this.getData=o,this.modalCtrl=i,this.postData=r,this.nav=c,this.router=s,this.user=a,this.stopPolling=new p.a,this.refresh$=new l.a(!0)}var o,i,r;return o=e,(i=[{key:"ngOnInit",value:function(){return Object(u.a)(this,void 0,void 0,regeneratorRuntime.mark((function t(){var n=this;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,this.user.userInfo();case 3:return t.next=5,this.location.getCoords();case 5:this.user_id=this.user.uuid,this.userLat=this.location.currentLocation.latitude,this.userLon=this.location.currentLocation.longitude,this.user$=this.refresh$.pipe(Object(f.a)((function(t){return n.getData.getUser(n.user.uuid)}))),this.posts$=this.refresh$.pipe(Object(f.a)((function(t){return n.getData.getPosts(n.userLat,n.userLon,n.user.uuid)}))),t.next=15;break;case 12:t.prev=12,t.t0=t.catch(0),this.nav.navigateRoot("error");case 15:case"end":return t.stop()}}),t,this,[[0,12]])})))}},{key:"ionViewWillEnter",value:function(){this.refresh$.next(!0)}},{key:"doRefresh",value:function(t){return Object(u.a)(this,void 0,void 0,regeneratorRuntime.mark((function n(){var e=this;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:setTimeout((function(){e.refresh$.next(!0),t.target.complete()}),1e3);case 1:case"end":return n.stop()}}),n)})))}},{key:"sortPosts",value:function(t){var n=this;"hot"==t.target.value?this.posts$=this.refresh$.pipe(Object(f.a)((function(t){return n.getData.getPostsSorted(n.userLat,n.userLon,n.user_id)}))):"new"==t.target.value&&(this.posts$=this.refresh$.pipe(Object(f.a)((function(t){return n.getData.getPosts(n.userLat,n.userLon,n.user_id)}))))}},{key:"createPost",value:function(){return Object(u.a)(this,void 0,void 0,regeneratorRuntime.mark((function t(){var n,e=this;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.modalCtrl.create({component:b.a});case 2:return n=t.sent,t.next=5,n.present();case 5:n.onDidDismiss().then((function(t){null!=t.data&&(e.userLat=e.location.currentLocation.latitude,e.userLon=e.location.currentLocation.longitude,e.postData.createPostRequest(e.userLat,e.userLon,e.user_id,t.data.postBod).then((function(){e.refresh$.next(!0)})))}));case 6:case"end":return t.stop()}}),t,this)})))}},{key:"gotToComments",value:function(t){var n={queryParams:{post_id:JSON.stringify(t)}};this.router.navigate(["comments"],n)}},{key:"ngOnDestroy",value:function(){this.stopPolling.next()}}])&&n(o.prototype,i),r&&n(o,r),e}(),O.\u0275fac=function(t){return new(t||O)(d.Hb(h.a),d.Hb(g.a),d.Hb(s.E),d.Hb(m.a),d.Hb(s.F),d.Hb(a.g),d.Hb(v.a))},O.\u0275cmp=d.Bb({type:O,selectors:[["app-home"]],decls:19,vars:7,consts:[[3,"translucent"],["mode","ios"],["lines","none","slot","start",4,"ngIf"],["mode","ios","value","new",3,"ionChange"],["value","new"],["value","hot"],["slot","end"],[3,"click"],["name","create-outline"],["slot","fixed",3,"ionRefresh"],["pullingIcon","circular"],["mode","ios",4,"ngIf"],["lines","none","slot","start"],[4,"ngFor","ngForOf"],[1,"body",3,"click"],["size","2",1,"vote"],[3,"reactions","post_id","post_user","likes"],["size","4",1,"time"],["name","time-outline"],["size","4","class","reply",3,"click",4,"ngIf"],["size","4",1,"distance"],[1,"text"],["size","4",1,"reply",3,"click"],["name","chatbubble-outline"],["name","chatbubbles-outline"]],template:function(t,n){1&t&&(d.Kb(0,"ion-header",0),d.Kb(1,"ion-toolbar",1),d.hc(2,J,3,1,"ion-chip",2),d.Vb(3,"async"),d.Kb(4,"ion-segment",3),d.Sb("ionChange",(function(t){return n.sortPosts(t)})),d.Kb(5,"ion-segment-button",4),d.Kb(6,"ion-label"),d.jc(7,"New"),d.Jb(),d.Jb(),d.Kb(8,"ion-segment-button",5),d.Kb(9,"ion-label"),d.jc(10,"Hot"),d.Jb(),d.Jb(),d.Jb(),d.Kb(11,"ion-buttons",6),d.Kb(12,"ion-button",7),d.Sb("click",(function(){return n.createPost()})),d.Ib(13,"ion-icon",8),d.Jb(),d.Jb(),d.Jb(),d.Jb(),d.Kb(14,"ion-content"),d.Kb(15,"ion-refresher",9),d.Sb("ionRefresh",(function(t){return n.doRefresh(t)})),d.Ib(16,"ion-refresher-content",10),d.Jb(),d.hc(17,P,2,1,"ion-list",11),d.Vb(18,"async"),d.Jb()),2&t&&(d.Zb("translucent",!0),d.xb(2),d.Zb("ngIf",d.Wb(3,3,n.user$)),d.xb(15),d.Zb("ngIf",d.Wb(18,5,n.posts$)))},directives:[s.m,s.A,r.k,s.w,s.H,s.x,s.q,s.f,s.e,s.n,s.j,s.s,s.t,s.h,s.r,r.j,s.g,s.v,s.i,x.a,s.k,s.l],pipes:[r.b,y.a],styles:["ion-footer[_ngcontent-%COMP%]{display:inline;margin:auto}ion-chip[_ngcontent-%COMP%], ion-refresher[_ngcontent-%COMP%]{--color:#5600f7}ion-chip[_ngcontent-%COMP%]{--background:#fff}ion-label[_ngcontent-%COMP%]{font-weight:700}ion-button[_ngcontent-%COMP%]{--color:#5600f7}ion-icon[_ngcontent-%COMP%]{vertical-align:middle;padding-bottom:3.5px}.time[_ngcontent-%COMP%]{padding-left:4px}.distance[_ngcontent-%COMP%], .time[_ngcontent-%COMP%]{font-size:13px;padding-top:1em;color:#7972da}.distance[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;margin:auto;padding-right:4px}.vote[_ngcontent-%COMP%]{display:flex;padding-bottom:0;align-items:center}.reply[_ngcontent-%COMP%]{font-size:13px;justify-content:center;padding-top:1em;display:flex}.text[_ngcontent-%COMP%]{margin-left:.5em}.body[_ngcontent-%COMP%]{padding:1em}@media (prefers-color-scheme:light){ion-card[_ngcontent-%COMP%]{box-shadow:5px 5px 15px 5px hsla(0,0%,66.7%,.41);--color:#5f656d}}@media (prefers-color-scheme:dark){ion-card[_ngcontent-%COMP%]{box-shadow:2px 2px 17px 4px rgba(0,0,0,.41)}}"]}),O)}],L=((C=function n(){t(this,n)}).\u0275mod=d.Fb({type:C}),C.\u0275inj=d.Eb({factory:function(t){return new(t||C)},imports:[[a.i.forChild(I)],a.i]}),C),$=i("nETc"),M=((j=function n(){t(this,n)}).\u0275mod=d.Fb({type:j}),j.\u0275inj=d.Eb({factory:function(t){return new(t||j)},imports:[[r.c,c.a,s.B,L,$.a]]}),j)}}])}();