(window.webpackJsonp=window.webpackJsonp||[]).push([[14],{"99Un":function(t,n,e){"use strict";e.r(n),e.d(n,"HomePageModule",(function(){return w}));var i=e("ofXK"),o=e("3Pt+"),s=e("TEn/"),c=e("tyNb"),r=e("mrSG"),b=e("4WUr"),a=e("2Vo4"),l=e("eIep"),u=e("XNiG"),h=e("fXoL"),d=e("yHma"),p=e("EQNs"),f=e("2ZZ0"),g=e("qfBg"),m=e("/Hhz"),x=e("Wu1i");function y(t,n){if(1&t&&(h.Kb(0,"ion-chip",12),h.Kb(1,"ion-label"),h.jc(2),h.Jb(),h.Jb()),2&t){const t=n.ngIf;h.xb(2),h.kc(t.karma)}}function J(t,n){if(1&t){const t=h.Lb();h.Kb(0,"ion-col",22),h.Sb("click",(function(){h.dc(t);const n=h.Ub().$implicit;return h.Ub(2).gotToComments(n.id)})),h.Ib(1,"ion-icon",23),h.Kb(2,"div",21),h.jc(3,"none"),h.Jb(),h.Jb()}}function _(t,n){if(1&t){const t=h.Lb();h.Kb(0,"ion-col",22),h.Sb("click",(function(){h.dc(t);const n=h.Ub().$implicit;return h.Ub(2).gotToComments(n.id)})),h.Ib(1,"ion-icon",23),h.Kb(2,"div",21),h.jc(3,"1 reply"),h.Jb(),h.Jb()}}function K(t,n){if(1&t){const t=h.Lb();h.Kb(0,"ion-col",22),h.Sb("click",(function(){h.dc(t);const n=h.Ub().$implicit;return h.Ub(2).gotToComments(n.id)})),h.Ib(1,"ion-icon",24),h.Kb(2,"div",21),h.jc(3),h.Jb(),h.Jb()}if(2&t){const t=h.Ub().$implicit;h.xb(3),h.lc("",t.reply_count," replies")}}function P(t,n){if(1&t){const t=h.Lb();h.Kb(0,"ion-card"),h.Kb(1,"ion-row"),h.Kb(2,"ion-col",14),h.Sb("click",(function(){h.dc(t);const e=n.$implicit;return h.Ub(2).gotToComments(e.id)})),h.jc(3),h.Jb(),h.Kb(4,"ion-col",15),h.Ib(5,"app-vote-button",16),h.Jb(),h.Jb(),h.Kb(6,"ion-footer",1),h.Kb(7,"ion-grid"),h.Kb(8,"ion-row"),h.Kb(9,"ion-col",17),h.Ib(10,"ion-icon",18),h.jc(11),h.Vb(12,"datepipe"),h.Jb(),h.hc(13,J,4,0,"ion-col",19),h.hc(14,_,4,0,"ion-col",19),h.hc(15,K,4,1,"ion-col",19),h.Kb(16,"ion-col",20),h.Kb(17,"div",21),h.jc(18),h.Jb(),h.Jb(),h.Jb(),h.Jb(),h.Jb(),h.Jb()}if(2&t){const t=n.$implicit,e=h.Ub().ngIf;h.xb(3),h.lc(" ",t.body," "),h.xb(2),h.Zb("reactions",e.react_list)("post_id",t.id)("post_user",t.user_id)("likes",t.likes),h.xb(6),h.lc(" ",h.Wb(12,10,t.timestamp)," "),h.xb(2),h.Zb("ngIf",0==t.reply_count),h.xb(1),h.Zb("ngIf",1==t.reply_count),h.xb(1),h.Zb("ngIf",t.reply_count>1),h.xb(3),h.lc(" ",t.distance," miles")}}function O(t,n){if(1&t&&(h.Kb(0,"ion-list",1),h.hc(1,P,19,12,"ion-card",13),h.Jb()),2&t){const t=n.ngIf;h.xb(1),h.Zb("ngForOf",t.post_list)}}const v=[{path:"",component:(()=>{class t{constructor(t,n,e,i,o,s,c){this.location=t,this.getData=n,this.modalCtrl=e,this.postData=i,this.nav=o,this.router=s,this.user=c,this.stopPolling=new u.a,this.refresh$=new a.a(!0)}ngOnInit(){return Object(r.a)(this,void 0,void 0,(function*(){try{yield this.user.userInfo(),yield this.location.getCoords(),this.user_id=this.user.uuid,this.userLat=this.location.currentLocation.latitude,this.userLon=this.location.currentLocation.longitude,this.user$=this.refresh$.pipe(Object(l.a)(t=>this.getData.getUser(this.user.uuid))),this.posts$=this.refresh$.pipe(Object(l.a)(t=>this.getData.getPosts(this.userLat,this.userLon,this.user.uuid)))}catch(t){this.nav.navigateRoot("error")}}))}ionViewWillEnter(){this.refresh$.next(!0)}doRefresh(t){return Object(r.a)(this,void 0,void 0,(function*(){setTimeout(()=>{this.refresh$.next(!0),t.target.complete()},1e3)}))}sortPosts(t){"hot"==t.target.value?this.posts$=this.refresh$.pipe(Object(l.a)(t=>this.getData.getPostsSorted(this.userLat,this.userLon,this.user_id))):"new"==t.target.value&&(this.posts$=this.refresh$.pipe(Object(l.a)(t=>this.getData.getPosts(this.userLat,this.userLon,this.user_id))))}createPost(){return Object(r.a)(this,void 0,void 0,(function*(){let t=yield this.modalCtrl.create({component:b.a});yield t.present(),t.onDidDismiss().then(t=>{null!=t.data&&(this.userLat=this.location.currentLocation.latitude,this.userLon=this.location.currentLocation.longitude,this.postData.createPostRequest(this.userLat,this.userLon,this.user_id,t.data.postBod).then(()=>{this.refresh$.next(!0)}))})}))}gotToComments(t){let n={queryParams:{post_id:JSON.stringify(t)}};this.router.navigate(["comments"],n)}ngOnDestroy(){this.stopPolling.next()}}return t.\u0275fac=function(n){return new(n||t)(h.Hb(d.a),h.Hb(p.a),h.Hb(s.E),h.Hb(f.a),h.Hb(s.F),h.Hb(c.g),h.Hb(g.a))},t.\u0275cmp=h.Bb({type:t,selectors:[["app-home"]],decls:19,vars:7,consts:[[3,"translucent"],["mode","ios"],["lines","none","slot","start",4,"ngIf"],["mode","ios","value","new",3,"ionChange"],["value","new"],["value","hot"],["slot","end"],[3,"click"],["name","create-outline"],["slot","fixed",3,"ionRefresh"],["pullingIcon","circular"],["mode","ios",4,"ngIf"],["lines","none","slot","start"],[4,"ngFor","ngForOf"],[1,"body",3,"click"],["size","2",1,"vote"],[3,"reactions","post_id","post_user","likes"],["size","4",1,"time"],["name","time-outline"],["size","4","class","reply",3,"click",4,"ngIf"],["size","4",1,"distance"],[1,"text"],["size","4",1,"reply",3,"click"],["name","chatbubble-outline"],["name","chatbubbles-outline"]],template:function(t,n){1&t&&(h.Kb(0,"ion-header",0),h.Kb(1,"ion-toolbar",1),h.hc(2,y,3,1,"ion-chip",2),h.Vb(3,"async"),h.Kb(4,"ion-segment",3),h.Sb("ionChange",(function(t){return n.sortPosts(t)})),h.Kb(5,"ion-segment-button",4),h.Kb(6,"ion-label"),h.jc(7,"New"),h.Jb(),h.Jb(),h.Kb(8,"ion-segment-button",5),h.Kb(9,"ion-label"),h.jc(10,"Hot"),h.Jb(),h.Jb(),h.Jb(),h.Kb(11,"ion-buttons",6),h.Kb(12,"ion-button",7),h.Sb("click",(function(){return n.createPost()})),h.Ib(13,"ion-icon",8),h.Jb(),h.Jb(),h.Jb(),h.Jb(),h.Kb(14,"ion-content"),h.Kb(15,"ion-refresher",9),h.Sb("ionRefresh",(function(t){return n.doRefresh(t)})),h.Ib(16,"ion-refresher-content",10),h.Jb(),h.hc(17,O,2,1,"ion-list",11),h.Vb(18,"async"),h.Jb()),2&t&&(h.Zb("translucent",!0),h.xb(2),h.Zb("ngIf",h.Wb(3,3,n.user$)),h.xb(15),h.Zb("ngIf",h.Wb(18,5,n.posts$)))},directives:[s.m,s.A,i.k,s.w,s.H,s.x,s.q,s.f,s.e,s.n,s.j,s.s,s.t,s.h,s.r,i.j,s.g,s.v,s.i,m.a,s.k,s.l],pipes:[i.b,x.a],styles:["ion-footer[_ngcontent-%COMP%]{display:inline;margin:auto}ion-chip[_ngcontent-%COMP%], ion-refresher[_ngcontent-%COMP%]{--color:#5600f7}ion-chip[_ngcontent-%COMP%]{--background:#fff}ion-label[_ngcontent-%COMP%]{font-weight:700}ion-button[_ngcontent-%COMP%]{--color:#5600f7}ion-icon[_ngcontent-%COMP%]{vertical-align:middle;padding-bottom:3.5px}.time[_ngcontent-%COMP%]{padding-left:4px}.distance[_ngcontent-%COMP%], .time[_ngcontent-%COMP%]{font-size:13px;padding-top:1em;color:#7972da}.distance[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;margin:auto;padding-right:4px}.vote[_ngcontent-%COMP%]{display:flex;padding-bottom:0;align-items:center}.reply[_ngcontent-%COMP%]{font-size:13px;justify-content:center;padding-top:1em;display:flex}.text[_ngcontent-%COMP%]{margin-left:.5em}.body[_ngcontent-%COMP%]{padding:1em}@media (prefers-color-scheme:light){ion-card[_ngcontent-%COMP%]{box-shadow:5px 5px 15px 5px hsla(0,0%,66.7%,.41);--color:#5f656d}}@media (prefers-color-scheme:dark){ion-card[_ngcontent-%COMP%]{box-shadow:2px 2px 17px 4px rgba(0,0,0,.41)}}"]}),t})()}];let C=(()=>{class t{}return t.\u0275mod=h.Fb({type:t}),t.\u0275inj=h.Eb({factory:function(n){return new(n||t)},imports:[[c.i.forChild(v)],c.i]}),t})();var j=e("nETc");let w=(()=>{class t{}return t.\u0275mod=h.Fb({type:t}),t.\u0275inj=h.Eb({factory:function(n){return new(n||t)},imports:[[i.c,o.a,s.B,C,j.a]]}),t})()}}]);